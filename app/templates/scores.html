<!DOCTYPE html>
<html>
  <head>
    <title>Scores des utilisateurs</title>
  </head>
  <body>
    <h1>Scores</h1>
    <ul>
      {% for score in scores %}
      <li>{{ score.nom }} : {{ score.score }}</li>
      {% endfor %}
    </ul>

    <h2>Ajouter / Mettre à jour un score</h2>
    <form id="scoreForm">
      Nom: <input type="text" name="nom" id="nom" required /> Score:
      <input type="number" name="score" id="score" required />
      <button type="submit">Ajouter / Mettre à jour</button>
    </form>

    <script>
      const form = document.getElementById("scoreForm");
      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const nom = document.getElementById("nom").value;
        const score = parseInt(document.getElementById("score").value);
        const res = await fetch("/api/score", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ nom, score }),
        });
        const data = await res.json();
        if (data.ok) {
          alert("Score ajouté / mis à jour !");
          location.reload();
        } else {
          alert("Erreur : " + data.error);
        }
      });
    </script>
  </body>
</html>
